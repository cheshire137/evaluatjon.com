"use strict";var app=angular.module("evaluatjonApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","angularMoment"]);app.config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/ratings.html",controller:"RatingsCtrl"}),a.otherwise({redirectTo:"/"})}]),app.factory("Rating",["$resource",function(a){return a("/api/ratings/:id.json",null,{update:{method:"PUT"}})}]),app.directive("starRating",function(){return{restrict:"A",template:'<ul class="star-rating"> <li ng-repeat="star in stars" ng-class="star">  <span class="star"></span> </li></ul>',scope:{ratingValue:"=",max:"="},link:function(a){var b=function(){a.stars=[];for(var b=0;b<a.max;b++)a.stars.push({filled:b<a.ratingValue,half:b-.5===a.ratingValue})};a.$watch("ratingValue",function(a,c){c&&b()})}}}),app.directive("starRater",function(){return{restrict:"A",template:'<ul class="star-rating mutable"> <li ng-repeat="star in stars" ng-class="star" ng-click="toggle($index)">  <span class="star"></span> </li></ul>',scope:{ratingValue:"=",max:"=",onRatingSelected:"&"},link:function(a){var b=function(){a.stars=[];for(var b=0;b<a.max;b++)a.stars.push({filled:b<a.ratingValue,half:b-.5===a.ratingValue})};b(),a.toggle=function(b){a.ratingValue=b+1,a.onRatingSelected({rating:b+1})},a.$watch("ratingValue",function(a,c){a!==c&&b()})}}}),angular.module("evaluatjonApp").controller("RatingsCtrl",["$scope","Rating",function(a,b){a.ratings=b.query(),a.new_rating={stars:0,error_messages:[]},a.set_new_rating_stars=function(b){a.new_rating.stars=b},a.create_rating=function(){var c=function(b){a.ratings.unshift(b),a.new_rating.stars=0,a.new_rating.error_messages.length=0,a.new_rating.dimension="",a.new_rating.comment="",a.new_rating.rater=""},d=function(b){a.new_rating.error_messages=b.data};b.save({rating:a.new_rating},c,d)}}]);